<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0" />
		<title>详情</title>
		<link rel="stylesheet" href="assest/mui/css/mui.css" />
		<link rel="stylesheet" href="css/goods-detail.css" />
	</head>

	<body>
		<div class="mui-content">
			<div class="top">
				<img src="img/pig.jpg" />
			</div>
			<div class="main-content">
				<article>
					优选猪后腿肉500g
				</article>
				<div class="mian-content-price">
					<span class="price">
						￥18.9
					</span>
					<button @click="addToCart()" class="mui-btn mui-btn-green">加入购物车</button>
				</div>
			</div>
			<div class="main-content-desc">
				商品介绍
			</div>
			<div onclick="goToCart()" class="shopping-cart-container">
				<span class="mui-badge mui-badge-danger circle-num">1</span>
				<img src="img/购物车.png" class="shopping-cart" />
			</div>
		</div>
		<script type="text/javascript" src="assest/mui/js/jquery-3.1.0.min.js"></script>
		<script type="text/javascript" src="assest/mui/js/mui.min.js"></script>
		<script type="text/javascript" src="js/vue.min.js"></script>
		<script type="text/javascript" src="js/global.js" ></script>
		<script type="text/javascript" src="js/sha1.js"></script>
		<script>
			var app = new Vue({
				data:{
					token:'',
					transfer_key:''
				},
				methods:{
                    addToCart:function () {
						$.ajax({
							url:'http://qpg.vlusi.com/api/api.php',
							data:{
                                act:'add_to_cart',
                                token:app.token,
                                goods:{}
							},
							success:function (data) {

                            }
						});
                    }
                    // ,
                    // goToCart:function () {
                    //     var u = navigator.userAgent;
                    //     var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端
                    //     var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
                    //     if (isAndroid == true) {
                    //         android.goToCart();
                    //     } else {
                    //         goToCart()
                    //     }
                    // }
				}
			});
            /**
			 * 获取商品详情
             */
			function getGoodsDetail(param) {
                $.ajax({
                    type:"post",
                    url:" http://qpg.vlusi.com/api/api.php",
                    async:true,
                    dataType:'json',
                    data:{
                        act:'search_goods_detail',
                        token:param.token,
						goods_id:param.goods_id,
                        signature:SHA2(`act=search_goods_detail&goods_id=${param.goods_id}&token=${param.token}${param.transfer_key}`)
                    },
                    success:function(data) {
                        if(data.code == 200) {
                            $.each(data.info[0].child, function(index,city) {
                                $.each(city.child, function(i,item) {
                                    app.cityList.push({region_id:item.region_id,name:item.region_name});
                                });
                            });
						}
                    },
                    error:function() {
						mui.toast('服务器异常!');
                    }
                });
            }
            
            function goToCart() {
				alert('去购物车');
            }

            $(function () {
				transformParams(getGoodsDetail);
            })
		</script>
	</body>

</html>